import{a as $}from"./chunk-QAKTIFU4.js";import{a as U}from"./chunk-SMIQJOBS.js";import{b as G,c,d as O,e as D,f as R,h as j,i as A,j as V,k,l as B,o as w,p as L}from"./chunk-UKXJF3TO.js";import"./chunk-YCMZOG5D.js";import{b as T,d as q}from"./chunk-ZN2XXCIA.js";import{Fa as C,Ib as N,Ja as p,Jb as x,Lb as M,Ua as a,Va as n,Wa as e,Xa as v,a as S,ab as h,b as E,bb as y,fb as P,hb as d,ib as _,jb as I,ua as r,za as m}from"./chunk-CFCTFSSM.js";function H(l,t){if(l&1&&(n(0,"div",22),d(1),e()),l&2){let i=y();r(),_(i.error)}}function J(l,t){l&1&&(n(0,"div",23),d(1," El c\xF3digo es requerido (m\xE1x. 50 caracteres) "),e())}function K(l,t){l&1&&(n(0,"div",23),d(1," El nombre es requerido (m\xE1x. 200 caracteres) "),e())}function Q(l,t){if(l&1&&(n(0,"option",24),d(1),e()),l&2){let i=t.$implicit;a("value",i.id),r(),I(" ",i.nombre," ")}}function W(l,t){l&1&&(n(0,"div",23),d(1," El tipo de producto es requerido "),e())}var z=class l{constructor(t,i,o,u,s){this.fb=t;this.productoService=i;this.tipoProductoService=o;this.router=u;this.route=s;this.productoForm=this.fb.group({codigo:["",[c.required,c.maxLength(50)]],nombre:["",[c.required,c.maxLength(200)]],descripcion:[""],tipoProductoId:[null,c.required],unidadMedida:["",c.maxLength(20)]})}productoForm;tiposProducto=[];isEditMode=!1;productoId=null;loading=!1;error=null;ngOnInit(){this.loadTiposProducto();let t=this.route.snapshot.paramMap.get("id");t&&(this.isEditMode=!0,this.productoId=+t,this.loadProducto(this.productoId))}loadTiposProducto(){this.tipoProductoService.getAll().subscribe({next:t=>{this.tiposProducto=t},error:t=>{this.error="Error al cargar tipos de producto",console.error(t)}})}loadProducto(t){this.loading=!0,this.productoService.getById(t).subscribe({next:i=>{this.productoForm.patchValue({codigo:i.codigo,nombre:i.nombre,descripcion:i.descripcion,tipoProductoId:i.tipoProductoId,unidadMedida:i.unidadMedida}),this.loading=!1},error:i=>{this.error="Error al cargar producto",this.loading=!1,console.error(i)}})}onSubmit(){if(this.productoForm.valid){this.loading=!0;let t=E(S({},this.productoForm.value),{tipoProductoId:Number(this.productoForm.value.tipoProductoId)});(this.isEditMode&&this.productoId?this.productoService.update(this.productoId,t):this.productoService.create(t)).subscribe({next:()=>{this.router.navigate(["/productos/list"])},error:o=>{this.error=o.error?.message||"Error al guardar producto",this.loading=!1,console.error(o)}})}}cancel(){this.router.navigate(["/productos/list"])}static \u0275fac=function(i){return new(i||l)(m(w),m(U),m($),m(q),m(T))};static \u0275cmp=C({type:l,selectors:[["app-producto-form"]],decls:38,vars:16,consts:[[1,"container"],[1,"header"],["class","alert alert-error",4,"ngIf"],[1,"form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","codigo"],["type","text","id","codigo","formControlName","codigo",1,"form-control"],["class","error-message",4,"ngIf"],["for","nombre"],["type","text","id","nombre","formControlName","nombre",1,"form-control"],["for","descripcion"],["id","descripcion","formControlName","descripcion","rows","3",1,"form-control"],["for","tipoProductoId"],["id","tipoProductoId","formControlName","tipoProductoId",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-row"],["for","unidadMedida"],["type","text","id","unidadMedida","formControlName","unidadMedida","placeholder","ej: kg, unidad, litro",1,"form-control"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert","alert-error"],[1,"error-message"],[3,"value"]],template:function(i,o){if(i&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),d(3),e()(),p(4,H,2,1,"div",2),n(5,"form",3),h("ngSubmit",function(){return o.onSubmit()}),n(6,"div",4)(7,"label",5),d(8,"C\xF3digo *"),e(),v(9,"input",6),p(10,J,2,0,"div",7),e(),n(11,"div",4)(12,"label",8),d(13,"Nombre *"),e(),v(14,"input",9),p(15,K,2,0,"div",7),e(),n(16,"div",4)(17,"label",10),d(18,"Descripci\xF3n"),e(),v(19,"textarea",11),e(),n(20,"div",4)(21,"label",12),d(22,"Tipo de Producto *"),e(),n(23,"select",13)(24,"option",14),d(25,"Seleccione un tipo"),e(),p(26,Q,2,2,"option",15),e(),p(27,W,2,0,"div",7),e(),n(28,"div",16)(29,"div",4)(30,"label",17),d(31,"Unidad de Medida"),e(),v(32,"input",18),e()(),n(33,"div",19)(34,"button",20),h("click",function(){return o.cancel()}),d(35," Cancelar "),e(),n(36,"button",21),d(37),e()()()()),i&2){let u,s,f,g,b,F;r(3),_(o.isEditMode?"Editar Producto":"Nuevo Producto"),r(),a("ngIf",o.error),r(),a("formGroup",o.productoForm),r(4),P("invalid",((u=o.productoForm.get("codigo"))==null?null:u.invalid)&&((u=o.productoForm.get("codigo"))==null?null:u.touched)),r(),a("ngIf",((s=o.productoForm.get("codigo"))==null?null:s.invalid)&&((s=o.productoForm.get("codigo"))==null?null:s.touched)),r(4),P("invalid",((f=o.productoForm.get("nombre"))==null?null:f.invalid)&&((f=o.productoForm.get("nombre"))==null?null:f.touched)),r(),a("ngIf",((g=o.productoForm.get("nombre"))==null?null:g.invalid)&&((g=o.productoForm.get("nombre"))==null?null:g.touched)),r(8),P("invalid",((b=o.productoForm.get("tipoProductoId"))==null?null:b.invalid)&&((b=o.productoForm.get("tipoProductoId"))==null?null:b.touched)),r(3),a("ngForOf",o.tiposProducto),r(),a("ngIf",((F=o.productoForm.get("tipoProductoId"))==null?null:F.invalid)&&((F=o.productoForm.get("tipoProductoId"))==null?null:F.touched)),r(7),a("disabled",o.loading),r(2),a("disabled",o.productoForm.invalid||o.loading),r(),I(" ",o.loading?"Guardando...":"Guardar"," ")}},dependencies:[M,N,x,L,R,k,B,G,V,O,D,j,A],encapsulation:2})};export{z as ProductoFormComponent};
