import{a as c}from"./chunk-YCMZOG5D.js";import{d as l}from"./chunk-ZN2XXCIA.js";import{L as s,O as a,Rb as u,S as o,k as n}from"./chunk-CFCTFSSM.js";var p=class r{constructor(t,e){this.http=t;this.router=e;let m=this.getToken(),i=localStorage.getItem("currentUser");m&&i&&this.currentUserSubject.next(JSON.parse(i))}apiUrl=`${c.apiUrl}/auth`;currentUserSubject=new n(null);currentUser$=this.currentUserSubject.asObservable();login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(s(e=>{this.setToken(e.access_token),this.currentUserSubject.next(e.user),localStorage.setItem("currentUser",JSON.stringify(e.user))}))}register(t){return this.http.post(`${this.apiUrl}/register`,t)}logout(){this.removeToken(),this.currentUserSubject.next(null),localStorage.removeItem("currentUser"),this.router.navigate(["/login"])}isLoggedIn(){return!!this.getToken()}getToken(){return localStorage.getItem("auth_token")}setToken(t){localStorage.setItem("auth_token",t)}removeToken(){localStorage.removeItem("auth_token")}getCurrentUser(){return this.currentUserSubject.value}static \u0275fac=function(e){return new(e||r)(o(u),o(l))};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{p as a};
